{"ast":null,"code":"import { ref, computed } from 'vue';\nimport { useStore } from 'vuex';\nimport { useRouter, useRoute } from 'vue-router';\nimport { useVuelidate } from '@vuelidate/core';\nimport { required, minLength } from '@vuelidate/validators';\nexport default {\n  name: 'LoginComponent',\n  setup() {\n    const store = useStore();\n    const router = useRouter();\n    const route = useRoute();\n\n    // 表單數據\n    const username = ref('');\n    const password = ref('');\n    const loading = ref(false);\n    const errorMessage = ref('');\n\n    // 表單驗證規則\n    const rules = {\n      username: {\n        required,\n        minLength: minLength(3)\n      },\n      password: {\n        required,\n        minLength: minLength(6)\n      }\n    };\n    const v$ = useVuelidate(rules, {\n      username,\n      password\n    });\n\n    // 登入方法\n    const login = async () => {\n      try {\n        errorMessage.value = '';\n\n        // 表單驗證\n        const isFormValid = await v$.value.$validate();\n        if (!isFormValid) {\n          return;\n        }\n        loading.value = true;\n\n        // 執行登入操作\n        await store.dispatch('auth/login', {\n          username: username.value,\n          password: password.value\n        });\n\n        // 登入成功後，根據redirect參數導航\n        const redirectPath = route.query.redirect || '/calendar';\n        router.push(redirectPath);\n      } catch (error) {\n        console.error('登入失敗:', error);\n        errorMessage.value = error.response?.data || '登入失敗，請檢查用戶名和密碼';\n      } finally {\n        loading.value = false;\n      }\n    };\n    return {\n      username,\n      password,\n      loading,\n      errorMessage,\n      v$,\n      login\n    };\n  }\n};","map":{"version":3,"names":["ref","computed","useStore","useRouter","useRoute","useVuelidate","required","minLength","name","setup","store","router","route","username","password","loading","errorMessage","rules","v$","login","value","isFormValid","$validate","dispatch","redirectPath","query","redirect","push","error","console","response","data"],"sources":["/Users/lidiannan/Documents/GitHub/calendar2/frontend/src/components/Login.vue"],"sourcesContent":["<template>\n  <div class=\"login-container\">\n    <Card class=\"login-card\">\n      <template #title>\n        <h1 class=\"login-title\">登入系統</h1>\n      </template>\n      <template #content>\n        <div class=\"login-form\">\n          <Message v-if=\"errorMessage\" severity=\"error\" :closable=\"false\">{{ errorMessage }}</Message>\n          \n          <div class=\"p-fluid\">\n            <div class=\"p-field\">\n              <label for=\"username\">用戶名</label>\n              <InputText \n                id=\"username\" \n                v-model.trim=\"username\" \n                placeholder=\"請輸入用戶名\"\n                :class=\"{ 'p-invalid': v$.username.$invalid && v$.username.$dirty }\"\n                @blur=\"v$.username.$touch()\"\n              />\n              <small v-if=\"v$.username.$invalid && v$.username.$dirty\" class=\"p-error\">\n                {{ v$.username.$errors[0].$message }}\n              </small>\n            </div>\n            \n            <div class=\"p-field\">\n              <label for=\"password\">密碼</label>\n              <Password \n                id=\"password\" \n                v-model=\"password\" \n                placeholder=\"請輸入密碼\" \n                :feedback=\"false\"\n                toggleMask\n                :class=\"{ 'p-invalid': v$.password.$invalid && v$.password.$dirty }\"\n                @blur=\"v$.password.$touch()\"\n              />\n              <small v-if=\"v$.password.$invalid && v$.password.$dirty\" class=\"p-error\">\n                {{ v$.password.$errors[0].$message }}\n              </small>\n            </div>\n            \n            <div class=\"login-actions\">\n              <Button \n                label=\"登入\" \n                icon=\"pi pi-sign-in\" \n                class=\"p-button-lg\" \n                :loading=\"loading\" \n                :disabled=\"loading\" \n                @click=\"login\"\n              />\n            </div>\n          </div>\n        </div>\n      </template>\n    </Card>\n  </div>\n</template>\n\n<script>\nimport { ref, computed } from 'vue'\nimport { useStore } from 'vuex'\nimport { useRouter, useRoute } from 'vue-router'\nimport { useVuelidate } from '@vuelidate/core'\nimport { required, minLength } from '@vuelidate/validators'\n\nexport default {\n  name: 'LoginComponent',\n  \n  setup() {\n    const store = useStore()\n    const router = useRouter()\n    const route = useRoute()\n    \n    // 表單數據\n    const username = ref('')\n    const password = ref('')\n    const loading = ref(false)\n    const errorMessage = ref('')\n    \n    // 表單驗證規則\n    const rules = {\n      username: { required, minLength: minLength(3) },\n      password: { required, minLength: minLength(6) }\n    }\n    \n    const v$ = useVuelidate(rules, { username, password })\n    \n    // 登入方法\n    const login = async () => {\n      try {\n        errorMessage.value = ''\n        \n        // 表單驗證\n        const isFormValid = await v$.value.$validate()\n        if (!isFormValid) {\n          return\n        }\n        \n        loading.value = true\n        \n        // 執行登入操作\n        await store.dispatch('auth/login', {\n          username: username.value,\n          password: password.value\n        })\n        \n        // 登入成功後，根據redirect參數導航\n        const redirectPath = route.query.redirect || '/calendar'\n        router.push(redirectPath)\n      } catch (error) {\n        console.error('登入失敗:', error)\n        errorMessage.value = error.response?.data || '登入失敗，請檢查用戶名和密碼'\n      } finally {\n        loading.value = false\n      }\n    }\n    \n    return {\n      username,\n      password,\n      loading,\n      errorMessage,\n      v$,\n      login\n    }\n  }\n}\n</script>\n\n<style scoped>\n.login-container {\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  min-height: calc(100vh - 100px);\n  padding: 2rem;\n}\n\n.login-card {\n  width: 100%;\n  max-width: 450px;\n  box-shadow: 0 4px 10px rgba(0, 0, 0, 0.05);\n}\n\n.login-title {\n  text-align: center;\n  color: #3B82F6;\n}\n\n.login-form {\n  margin-top: 1rem;\n}\n\n.p-field {\n  margin-bottom: 1.5rem;\n}\n\n.p-field label {\n  display: block;\n  margin-bottom: 0.5rem;\n  font-weight: 600;\n}\n\n.login-actions {\n  margin-top: 2rem;\n  display: flex;\n  justify-content: center;\n}\n\n.p-error {\n  color: #f44336;\n  font-size: 0.875rem;\n}\n</style>"],"mappings":"AA2DA,SAASA,GAAG,EAAEC,QAAO,QAAS,KAAI;AAClC,SAASC,QAAO,QAAS,MAAK;AAC9B,SAASC,SAAS,EAAEC,QAAO,QAAS,YAAW;AAC/C,SAASC,YAAW,QAAS,iBAAgB;AAC7C,SAASC,QAAQ,EAAEC,SAAQ,QAAS,uBAAsB;AAE1D,eAAe;EACbC,IAAI,EAAE,gBAAgB;EAEtBC,KAAKA,CAAA,EAAG;IACN,MAAMC,KAAI,GAAIR,QAAQ,CAAC;IACvB,MAAMS,MAAK,GAAIR,SAAS,CAAC;IACzB,MAAMS,KAAI,GAAIR,QAAQ,CAAC;;IAEvB;IACA,MAAMS,QAAO,GAAIb,GAAG,CAAC,EAAE;IACvB,MAAMc,QAAO,GAAId,GAAG,CAAC,EAAE;IACvB,MAAMe,OAAM,GAAIf,GAAG,CAAC,KAAK;IACzB,MAAMgB,YAAW,GAAIhB,GAAG,CAAC,EAAE;;IAE3B;IACA,MAAMiB,KAAI,GAAI;MACZJ,QAAQ,EAAE;QAAEP,QAAQ;QAAEC,SAAS,EAAEA,SAAS,CAAC,CAAC;MAAE,CAAC;MAC/CO,QAAQ,EAAE;QAAER,QAAQ;QAAEC,SAAS,EAAEA,SAAS,CAAC,CAAC;MAAE;IAChD;IAEA,MAAMW,EAAC,GAAIb,YAAY,CAACY,KAAK,EAAE;MAAEJ,QAAQ;MAAEC;IAAS,CAAC;;IAErD;IACA,MAAMK,KAAI,GAAI,MAAAA,CAAA,KAAY;MACxB,IAAI;QACFH,YAAY,CAACI,KAAI,GAAI,EAAC;;QAEtB;QACA,MAAMC,WAAU,GAAI,MAAMH,EAAE,CAACE,KAAK,CAACE,SAAS,CAAC;QAC7C,IAAI,CAACD,WAAW,EAAE;UAChB;QACF;QAEAN,OAAO,CAACK,KAAI,GAAI,IAAG;;QAEnB;QACA,MAAMV,KAAK,CAACa,QAAQ,CAAC,YAAY,EAAE;UACjCV,QAAQ,EAAEA,QAAQ,CAACO,KAAK;UACxBN,QAAQ,EAAEA,QAAQ,CAACM;QACrB,CAAC;;QAED;QACA,MAAMI,YAAW,GAAIZ,KAAK,CAACa,KAAK,CAACC,QAAO,IAAK,WAAU;QACvDf,MAAM,CAACgB,IAAI,CAACH,YAAY;MAC1B,EAAE,OAAOI,KAAK,EAAE;QACdC,OAAO,CAACD,KAAK,CAAC,OAAO,EAAEA,KAAK;QAC5BZ,YAAY,CAACI,KAAI,GAAIQ,KAAK,CAACE,QAAQ,EAAEC,IAAG,IAAK,gBAAe;MAC9D,UAAU;QACRhB,OAAO,CAACK,KAAI,GAAI,KAAI;MACtB;IACF;IAEA,OAAO;MACLP,QAAQ;MACRC,QAAQ;MACRC,OAAO;MACPC,YAAY;MACZE,EAAE;MACFC;IACF;EACF;AACF","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}