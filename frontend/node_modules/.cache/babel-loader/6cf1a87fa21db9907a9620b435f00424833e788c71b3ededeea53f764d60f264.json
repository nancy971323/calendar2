{"ast":null,"code":"import { computed, onMounted } from 'vue';\nimport { useStore } from 'vuex';\nimport { useRouter } from 'vue-router';\nexport default {\n  name: 'App',\n  setup() {\n    const store = useStore();\n    const router = useRouter();\n\n    // 計算屬性\n    const isLoggedIn = computed(() => store.getters['auth/isAuthenticated']);\n    const currentUser = computed(() => store.getters['auth/currentUser']);\n    const securityLevelText = computed(() => {\n      if (!currentUser.value || !currentUser.value.securityLevel) return '';\n      const level = currentUser.value.securityLevel;\n      switch (level) {\n        case 'LEVEL_1':\n          return '最高權限';\n        case 'LEVEL_2':\n          return '高級權限';\n        case 'LEVEL_3':\n          return '中級權限';\n        case 'LEVEL_4':\n          return '基本權限';\n        default:\n          return level;\n      }\n    });\n\n    // 方法\n    const logout = async () => {\n      try {\n        await store.dispatch('auth/logout');\n        router.push('/login');\n      } catch (error) {\n        console.error('登出失敗:', error);\n      }\n    };\n\n    // 生命週期鉤子\n    onMounted(async () => {\n      // 如果本地存儲中有token，嘗試自動登入\n      const token = localStorage.getItem('token');\n      if (token) {\n        try {\n          await store.dispatch('auth/checkAuth');\n        } catch (error) {\n          console.error('Token驗證失敗:', error);\n          localStorage.removeItem('token');\n        }\n      }\n    });\n    return {\n      isLoggedIn,\n      currentUser,\n      securityLevelText,\n      logout\n    };\n  }\n};","map":{"version":3,"names":["computed","onMounted","useStore","useRouter","name","setup","store","router","isLoggedIn","getters","currentUser","securityLevelText","value","securityLevel","level","logout","dispatch","push","error","console","token","localStorage","getItem","removeItem"],"sources":["/Users/lidiannan/Documents/GitHub/calendar2/frontend/src/App.vue"],"sourcesContent":["<template>\n  <div id=\"app\">\n    <Toast position=\"top-right\" />\n    <ConfirmDialog></ConfirmDialog>\n    <div class=\"layout-container\">\n      <header v-if=\"isLoggedIn\">\n        <div class=\"header-content\">\n          <div class=\"header-logo\">\n            <router-link to=\"/\">企業行事曆系統</router-link>\n          </div>\n          <div class=\"header-menu\">\n            <Button @click=\"$router.push('/')\" label=\"首頁\" icon=\"pi pi-home\" class=\"p-button-text\" />\n            <Button @click=\"$router.push('/calendar')\" label=\"行事曆\" icon=\"pi pi-calendar\" class=\"p-button-text\" />\n            <Button v-if=\"isLoggedIn\" @click=\"$router.push('/admin')\" label=\"後臺管理\" icon=\"pi pi-cog\" class=\"p-button-text\" />\n          </div>\n          <div class=\"header-user\" v-if=\"isLoggedIn\">\n            <span class=\"user-info\">{{ currentUser.fullName }} ({{ securityLevelText }})</span>\n            <Button @click=\"logout\" label=\"登出\" icon=\"pi pi-sign-out\" class=\"p-button-text\" />\n          </div>\n        </div>\n      </header>\n      <main class=\"main-content\">\n        <router-view />\n      </main>\n      <footer v-if=\"isLoggedIn\">\n        <div class=\"footer-content\">\n          <p>&copy; 2025 企業行事曆系統</p>\n        </div>\n      </footer>\n    </div>\n  </div>\n</template>\n\n<script>\nimport { computed, onMounted } from 'vue'\nimport { useStore } from 'vuex'\nimport { useRouter } from 'vue-router'\n\nexport default {\n  name: 'App',\n  setup() {\n    const store = useStore()\n    const router = useRouter()\n\n    // 計算屬性\n    const isLoggedIn = computed(() => store.getters['auth/isAuthenticated'])\n    const currentUser = computed(() => store.getters['auth/currentUser'])\n    const securityLevelText = computed(() => {\n      if (!currentUser.value || !currentUser.value.securityLevel) return ''\n      \n      const level = currentUser.value.securityLevel\n      switch(level) {\n        case 'LEVEL_1': return '最高權限'\n        case 'LEVEL_2': return '高級權限'\n        case 'LEVEL_3': return '中級權限'\n        case 'LEVEL_4': return '基本權限'\n        default: return level\n      }\n    })\n\n    // 方法\n    const logout = async () => {\n      try {\n        await store.dispatch('auth/logout')\n        router.push('/login')\n      } catch (error) {\n        console.error('登出失敗:', error)\n      }\n    }\n\n    // 生命週期鉤子\n    onMounted(async () => {\n      // 如果本地存儲中有token，嘗試自動登入\n      const token = localStorage.getItem('token')\n      if (token) {\n        try {\n          await store.dispatch('auth/checkAuth')\n        } catch (error) {\n          console.error('Token驗證失敗:', error)\n          localStorage.removeItem('token')\n        }\n      }\n    })\n\n    return {\n      isLoggedIn,\n      currentUser,\n      securityLevelText,\n      logout\n    }\n  }\n}\n</script>\n\n<style>\nhtml, body {\n  margin: 0;\n  padding: 0;\n  font-family: -apple-system, BlinkMacSystemFont, \"Segoe UI\", Roboto, Helvetica, Arial, sans-serif;\n  height: 100%;\n}\n\n#app {\n  height: 100%;\n}\n\n.layout-container {\n  display: flex;\n  flex-direction: column;\n  min-height: 100vh;\n}\n\nheader {\n  background-color: #ffffff;\n  box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);\n  padding: 0.5rem 2rem;\n}\n\n.header-content {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n}\n\n.header-logo a {\n  color: #3B82F6;\n  font-size: 1.5rem;\n  font-weight: 700;\n  text-decoration: none;\n}\n\n.header-menu {\n  display: flex;\n  gap: 1rem;\n}\n\n.header-user {\n  display: flex;\n  align-items: center;\n  gap: 1rem;\n}\n\n.user-info {\n  font-weight: 600;\n}\n\n.main-content {\n  flex: 1;\n  padding: 2rem;\n  background-color: #f8f9fa;\n}\n\nfooter {\n  background-color: #ffffff;\n  padding: 1rem 2rem;\n  border-top: 1px solid #e9ecef;\n}\n\n.footer-content {\n  text-align: center;\n  color: #6c757d;\n}\n</style>"],"mappings":"AAkCA,SAASA,QAAQ,EAAEC,SAAQ,QAAS,KAAI;AACxC,SAASC,QAAO,QAAS,MAAK;AAC9B,SAASC,SAAQ,QAAS,YAAW;AAErC,eAAe;EACbC,IAAI,EAAE,KAAK;EACXC,KAAKA,CAAA,EAAG;IACN,MAAMC,KAAI,GAAIJ,QAAQ,CAAC;IACvB,MAAMK,MAAK,GAAIJ,SAAS,CAAC;;IAEzB;IACA,MAAMK,UAAS,GAAIR,QAAQ,CAAC,MAAMM,KAAK,CAACG,OAAO,CAAC,sBAAsB,CAAC;IACvE,MAAMC,WAAU,GAAIV,QAAQ,CAAC,MAAMM,KAAK,CAACG,OAAO,CAAC,kBAAkB,CAAC;IACpE,MAAME,iBAAgB,GAAIX,QAAQ,CAAC,MAAM;MACvC,IAAI,CAACU,WAAW,CAACE,KAAI,IAAK,CAACF,WAAW,CAACE,KAAK,CAACC,aAAa,EAAE,OAAO,EAAC;MAEpE,MAAMC,KAAI,GAAIJ,WAAW,CAACE,KAAK,CAACC,aAAY;MAC5C,QAAOC,KAAK;QACV,KAAK,SAAS;UAAE,OAAO,MAAK;QAC5B,KAAK,SAAS;UAAE,OAAO,MAAK;QAC5B,KAAK,SAAS;UAAE,OAAO,MAAK;QAC5B,KAAK,SAAS;UAAE,OAAO,MAAK;QAC5B;UAAS,OAAOA,KAAI;MACtB;IACF,CAAC;;IAED;IACA,MAAMC,MAAK,GAAI,MAAAA,CAAA,KAAY;MACzB,IAAI;QACF,MAAMT,KAAK,CAACU,QAAQ,CAAC,aAAa;QAClCT,MAAM,CAACU,IAAI,CAAC,QAAQ;MACtB,EAAE,OAAOC,KAAK,EAAE;QACdC,OAAO,CAACD,KAAK,CAAC,OAAO,EAAEA,KAAK;MAC9B;IACF;;IAEA;IACAjB,SAAS,CAAC,YAAY;MACpB;MACA,MAAMmB,KAAI,GAAIC,YAAY,CAACC,OAAO,CAAC,OAAO;MAC1C,IAAIF,KAAK,EAAE;QACT,IAAI;UACF,MAAMd,KAAK,CAACU,QAAQ,CAAC,gBAAgB;QACvC,EAAE,OAAOE,KAAK,EAAE;UACdC,OAAO,CAACD,KAAK,CAAC,YAAY,EAAEA,KAAK;UACjCG,YAAY,CAACE,UAAU,CAAC,OAAO;QACjC;MACF;IACF,CAAC;IAED,OAAO;MACLf,UAAU;MACVE,WAAW;MACXC,iBAAiB;MACjBI;IACF;EACF;AACF","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}