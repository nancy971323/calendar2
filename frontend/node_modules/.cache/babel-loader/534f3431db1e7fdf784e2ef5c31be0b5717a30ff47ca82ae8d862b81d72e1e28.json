{"ast":null,"code":"import { createElementVNode as _createElementVNode, toDisplayString as _toDisplayString, createTextVNode as _createTextVNode, resolveComponent as _resolveComponent, withCtx as _withCtx, openBlock as _openBlock, createBlock as _createBlock, createCommentVNode as _createCommentVNode, normalizeClass as _normalizeClass, createVNode as _createVNode, createElementBlock as _createElementBlock } from \"vue\";\nvar _hoisted_1 = {\n  \"class\": \"login-container\"\n};\nvar _hoisted_2 = {\n  \"class\": \"login-form\"\n};\nvar _hoisted_3 = {\n  \"class\": \"p-fluid\"\n};\nvar _hoisted_4 = {\n  \"class\": \"p-field\"\n};\nvar _hoisted_5 = {\n  key: 0,\n  \"class\": \"p-error\"\n};\nvar _hoisted_6 = {\n  \"class\": \"p-field\"\n};\nvar _hoisted_7 = {\n  key: 0,\n  \"class\": \"p-error\"\n};\nvar _hoisted_8 = {\n  \"class\": \"login-actions\"\n};\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  var _component_Message = _resolveComponent(\"Message\");\n  var _component_InputText = _resolveComponent(\"InputText\");\n  var _component_Password = _resolveComponent(\"Password\");\n  var _component_Button = _resolveComponent(\"Button\");\n  var _component_Card = _resolveComponent(\"Card\");\n  return _openBlock(), _createElementBlock(\"div\", _hoisted_1, [_createVNode(_component_Card, {\n    \"class\": \"login-card\"\n  }, {\n    title: _withCtx(function () {\n      return _cache[4] || (_cache[4] = [_createElementVNode(\"h1\", {\n        \"class\": \"login-title\"\n      }, \"登入系統\", -1 /* HOISTED */)]);\n    }),\n    content: _withCtx(function () {\n      return [_createElementVNode(\"div\", _hoisted_2, [$setup.errorMessage ? (_openBlock(), _createBlock(_component_Message, {\n        key: 0,\n        severity: \"error\",\n        closable: false\n      }, {\n        \"default\": _withCtx(function () {\n          return [_createTextVNode(_toDisplayString($setup.errorMessage), 1 /* TEXT */)];\n        }),\n        _: 1 /* STABLE */\n      })) : _createCommentVNode(\"v-if\", true), _createElementVNode(\"div\", _hoisted_3, [_createElementVNode(\"div\", _hoisted_4, [_cache[5] || (_cache[5] = _createElementVNode(\"label\", {\n        \"for\": \"username\"\n      }, \"用戶名\", -1 /* HOISTED */)), _createVNode(_component_InputText, {\n        id: \"username\",\n        modelValue: $setup.username,\n        \"onUpdate:modelValue\": _cache[0] || (_cache[0] = function ($event) {\n          return $setup.username = $event;\n        }),\n        modelModifiers: {\n          trim: true\n        },\n        placeholder: \"請輸入用戶名\",\n        \"class\": _normalizeClass({\n          'p-invalid': $setup.v$.username.$invalid && $setup.v$.username.$dirty\n        }),\n        onBlur: _cache[1] || (_cache[1] = function ($event) {\n          return $setup.v$.username.$touch();\n        })\n      }, null, 8 /* PROPS */, [\"modelValue\", \"class\"]), $setup.v$.username.$invalid && $setup.v$.username.$dirty ? (_openBlock(), _createElementBlock(\"small\", _hoisted_5, _toDisplayString($setup.v$.username.$errors[0].$message), 1 /* TEXT */)) : _createCommentVNode(\"v-if\", true)]), _createElementVNode(\"div\", _hoisted_6, [_cache[6] || (_cache[6] = _createElementVNode(\"label\", {\n        \"for\": \"password\"\n      }, \"密碼\", -1 /* HOISTED */)), _createVNode(_component_Password, {\n        id: \"password\",\n        modelValue: $setup.password,\n        \"onUpdate:modelValue\": _cache[2] || (_cache[2] = function ($event) {\n          return $setup.password = $event;\n        }),\n        placeholder: \"請輸入密碼\",\n        feedback: false,\n        toggleMask: \"\",\n        \"class\": _normalizeClass({\n          'p-invalid': $setup.v$.password.$invalid && $setup.v$.password.$dirty\n        }),\n        onBlur: _cache[3] || (_cache[3] = function ($event) {\n          return $setup.v$.password.$touch();\n        })\n      }, null, 8 /* PROPS */, [\"modelValue\", \"class\"]), $setup.v$.password.$invalid && $setup.v$.password.$dirty ? (_openBlock(), _createElementBlock(\"small\", _hoisted_7, _toDisplayString($setup.v$.password.$errors[0].$message), 1 /* TEXT */)) : _createCommentVNode(\"v-if\", true)]), _createElementVNode(\"div\", _hoisted_8, [_createVNode(_component_Button, {\n        label: \"登入\",\n        icon: \"pi pi-sign-in\",\n        \"class\": \"p-button-lg\",\n        loading: $setup.loading,\n        disabled: $setup.loading,\n        onClick: $setup.login\n      }, null, 8 /* PROPS */, [\"loading\", \"disabled\", \"onClick\"])])])])];\n    }),\n    _: 1 /* STABLE */\n  })]);\n}","map":{"version":3,"names":["key","_createElementBlock","_hoisted_1","_createVNode","_component_Card","title","_withCtx","_cache","_createElementVNode","content","_hoisted_2","$setup","errorMessage","_createBlock","_component_Message","severity","closable","_createTextVNode","_toDisplayString","_","_createCommentVNode","_hoisted_3","_hoisted_4","_component_InputText","id","modelValue","username","$event","modelModifiers","trim","placeholder","_normalizeClass","v$","$invalid","$dirty","onBlur","$touch","_hoisted_5","$errors","$message","_hoisted_6","_component_Password","password","feedback","toggleMask","_hoisted_7","_hoisted_8","_component_Button","label","icon","loading","disabled","onClick","login"],"sources":["/Users/lidiannan/Documents/GitHub/calendar2/frontend/src/components/Login.vue"],"sourcesContent":["<template>\n  <div class=\"login-container\">\n    <Card class=\"login-card\">\n      <template #title>\n        <h1 class=\"login-title\">登入系統</h1>\n      </template>\n      <template #content>\n        <div class=\"login-form\">\n          <Message v-if=\"errorMessage\" severity=\"error\" :closable=\"false\">{{ errorMessage }}</Message>\n          \n          <div class=\"p-fluid\">\n            <div class=\"p-field\">\n              <label for=\"username\">用戶名</label>\n              <InputText \n                id=\"username\" \n                v-model.trim=\"username\" \n                placeholder=\"請輸入用戶名\"\n                :class=\"{ 'p-invalid': v$.username.$invalid && v$.username.$dirty }\"\n                @blur=\"v$.username.$touch()\"\n              />\n              <small v-if=\"v$.username.$invalid && v$.username.$dirty\" class=\"p-error\">\n                {{ v$.username.$errors[0].$message }}\n              </small>\n            </div>\n            \n            <div class=\"p-field\">\n              <label for=\"password\">密碼</label>\n              <Password \n                id=\"password\" \n                v-model=\"password\" \n                placeholder=\"請輸入密碼\" \n                :feedback=\"false\"\n                toggleMask\n                :class=\"{ 'p-invalid': v$.password.$invalid && v$.password.$dirty }\"\n                @blur=\"v$.password.$touch()\"\n              />\n              <small v-if=\"v$.password.$invalid && v$.password.$dirty\" class=\"p-error\">\n                {{ v$.password.$errors[0].$message }}\n              </small>\n            </div>\n            \n            <div class=\"login-actions\">\n              <Button \n                label=\"登入\" \n                icon=\"pi pi-sign-in\" \n                class=\"p-button-lg\" \n                :loading=\"loading\" \n                :disabled=\"loading\" \n                @click=\"login\"\n              />\n            </div>\n          </div>\n        </div>\n      </template>\n    </Card>\n  </div>\n</template>\n\n<script>\nimport { ref } from 'vue'\nimport { useStore } from 'vuex'\nimport { useRouter, useRoute } from 'vue-router'\nimport { useVuelidate } from '@vuelidate/core'\nimport { required, minLength } from '@vuelidate/validators'\n\nexport default {\n  name: 'LoginComponent',\n  \n  setup() {\n    const store = useStore()\n    const router = useRouter()\n    const route = useRoute()\n    \n    // 表單數據\n    const username = ref('')\n    const password = ref('')\n    const loading = ref(false)\n    const errorMessage = ref('')\n    \n    // 表單驗證規則\n    const rules = {\n      username: { required, minLength: minLength(3) },\n      password: { required, minLength: minLength(6) }\n    }\n    \n    const v$ = useVuelidate(rules, { username, password })\n    \n    // 登入方法\n    const login = async () => {\n      try {\n        errorMessage.value = ''\n        \n        // 表單驗證\n        const isFormValid = await v$.value.$validate()\n        if (!isFormValid) {\n          return\n        }\n        \n        loading.value = true\n        \n        // 執行登入操作\n        await store.dispatch('auth/login', {\n          username: username.value,\n          password: password.value\n        })\n        \n        // 登入成功後，根據redirect參數導航\n        const redirectPath = route.query.redirect || '/calendar'\n        router.push(redirectPath)\n      } catch (error) {\n        console.error('登入失敗:', error)\n        errorMessage.value = error.response?.data || '登入失敗，請檢查用戶名和密碼'\n      } finally {\n        loading.value = false\n      }\n    }\n    \n    return {\n      username,\n      password,\n      loading,\n      errorMessage,\n      v$,\n      login\n    }\n  }\n}\n</script>\n\n<style scoped>\n.login-container {\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  min-height: calc(100vh - 100px);\n  padding: 2rem;\n}\n\n.login-card {\n  width: 100%;\n  max-width: 450px;\n  box-shadow: 0 4px 10px rgba(0, 0, 0, 0.05);\n}\n\n.login-title {\n  text-align: center;\n  color: #3B82F6;\n}\n\n.login-form {\n  margin-top: 1rem;\n}\n\n.p-field {\n  margin-bottom: 1.5rem;\n}\n\n.p-field label {\n  display: block;\n  margin-bottom: 0.5rem;\n  font-weight: 600;\n}\n\n.login-actions {\n  margin-top: 2rem;\n  display: flex;\n  justify-content: center;\n}\n\n.p-error {\n  color: #f44336;\n  font-size: 0.875rem;\n}\n</style>"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}