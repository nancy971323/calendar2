{"ast":null,"code":"import { createElementVNode as _createElementVNode, toDisplayString as _toDisplayString, createTextVNode as _createTextVNode, resolveComponent as _resolveComponent, withCtx as _withCtx, openBlock as _openBlock, createBlock as _createBlock, createCommentVNode as _createCommentVNode, normalizeClass as _normalizeClass, createVNode as _createVNode, createElementBlock as _createElementBlock } from \"vue\";\nconst _hoisted_1 = {\n  class: \"login-container\"\n};\nconst _hoisted_2 = {\n  class: \"login-form\"\n};\nconst _hoisted_3 = {\n  class: \"p-fluid\"\n};\nconst _hoisted_4 = {\n  class: \"p-field\"\n};\nconst _hoisted_5 = {\n  key: 0,\n  class: \"p-error\"\n};\nconst _hoisted_6 = {\n  class: \"p-field\"\n};\nconst _hoisted_7 = {\n  key: 0,\n  class: \"p-error\"\n};\nconst _hoisted_8 = {\n  class: \"login-actions\"\n};\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  const _component_Message = _resolveComponent(\"Message\");\n  const _component_InputText = _resolveComponent(\"InputText\");\n  const _component_Password = _resolveComponent(\"Password\");\n  const _component_Button = _resolveComponent(\"Button\");\n  const _component_Card = _resolveComponent(\"Card\");\n  return _openBlock(), _createElementBlock(\"div\", _hoisted_1, [_createVNode(_component_Card, {\n    class: \"login-card\"\n  }, {\n    title: _withCtx(() => _cache[4] || (_cache[4] = [_createElementVNode(\"h1\", {\n      class: \"login-title\"\n    }, \"登入系統\", -1 /* HOISTED */)])),\n    content: _withCtx(() => [_createElementVNode(\"div\", _hoisted_2, [$setup.errorMessage ? (_openBlock(), _createBlock(_component_Message, {\n      key: 0,\n      severity: \"error\",\n      closable: false\n    }, {\n      default: _withCtx(() => [_createTextVNode(_toDisplayString($setup.errorMessage), 1 /* TEXT */)]),\n      _: 1 /* STABLE */\n    })) : _createCommentVNode(\"v-if\", true), _createElementVNode(\"div\", _hoisted_3, [_createElementVNode(\"div\", _hoisted_4, [_cache[5] || (_cache[5] = _createElementVNode(\"label\", {\n      for: \"username\"\n    }, \"用戶名\", -1 /* HOISTED */)), _createVNode(_component_InputText, {\n      id: \"username\",\n      modelValue: $setup.username,\n      \"onUpdate:modelValue\": _cache[0] || (_cache[0] = $event => $setup.username = $event),\n      modelModifiers: {\n        trim: true\n      },\n      placeholder: \"請輸入用戶名\",\n      class: _normalizeClass({\n        'p-invalid': $setup.v$.username.$invalid && $setup.v$.username.$dirty\n      }),\n      onBlur: _cache[1] || (_cache[1] = $event => $setup.v$.username.$touch())\n    }, null, 8 /* PROPS */, [\"modelValue\", \"class\"]), $setup.v$.username.$invalid && $setup.v$.username.$dirty ? (_openBlock(), _createElementBlock(\"small\", _hoisted_5, _toDisplayString($setup.v$.username.$errors[0].$message), 1 /* TEXT */)) : _createCommentVNode(\"v-if\", true)]), _createElementVNode(\"div\", _hoisted_6, [_cache[6] || (_cache[6] = _createElementVNode(\"label\", {\n      for: \"password\"\n    }, \"密碼\", -1 /* HOISTED */)), _createVNode(_component_Password, {\n      id: \"password\",\n      modelValue: $setup.password,\n      \"onUpdate:modelValue\": _cache[2] || (_cache[2] = $event => $setup.password = $event),\n      placeholder: \"請輸入密碼\",\n      feedback: false,\n      toggleMask: \"\",\n      class: _normalizeClass({\n        'p-invalid': $setup.v$.password.$invalid && $setup.v$.password.$dirty\n      }),\n      onBlur: _cache[3] || (_cache[3] = $event => $setup.v$.password.$touch())\n    }, null, 8 /* PROPS */, [\"modelValue\", \"class\"]), $setup.v$.password.$invalid && $setup.v$.password.$dirty ? (_openBlock(), _createElementBlock(\"small\", _hoisted_7, _toDisplayString($setup.v$.password.$errors[0].$message), 1 /* TEXT */)) : _createCommentVNode(\"v-if\", true)]), _createElementVNode(\"div\", _hoisted_8, [_createVNode(_component_Button, {\n      label: \"登入\",\n      icon: \"pi pi-sign-in\",\n      class: \"p-button-lg\",\n      loading: $setup.loading,\n      disabled: $setup.loading,\n      onClick: $setup.login\n    }, null, 8 /* PROPS */, [\"loading\", \"disabled\", \"onClick\"])])])])]),\n    _: 1 /* STABLE */\n  })]);\n}","map":{"version":3,"names":["class","key","_createElementBlock","_hoisted_1","_createVNode","_component_Card","title","_withCtx","_cache","_createElementVNode","content","_hoisted_2","$setup","errorMessage","_createBlock","_component_Message","severity","closable","default","_createTextVNode","_toDisplayString","_","_createCommentVNode","_hoisted_3","_hoisted_4","for","_component_InputText","id","modelValue","username","$event","modelModifiers","trim","placeholder","_normalizeClass","v$","$invalid","$dirty","onBlur","$touch","_hoisted_5","$errors","$message","_hoisted_6","_component_Password","password","feedback","toggleMask","_hoisted_7","_hoisted_8","_component_Button","label","icon","loading","disabled","onClick","login"],"sources":["/Users/lidiannan/Documents/GitHub/calendar2/frontend/src/components/Login.vue"],"sourcesContent":["<template>\n  <div class=\"login-container\">\n    <Card class=\"login-card\">\n      <template #title>\n        <h1 class=\"login-title\">登入系統</h1>\n      </template>\n      <template #content>\n        <div class=\"login-form\">\n          <Message v-if=\"errorMessage\" severity=\"error\" :closable=\"false\">{{ errorMessage }}</Message>\n          \n          <div class=\"p-fluid\">\n            <div class=\"p-field\">\n              <label for=\"username\">用戶名</label>\n              <InputText \n                id=\"username\" \n                v-model.trim=\"username\" \n                placeholder=\"請輸入用戶名\"\n                :class=\"{ 'p-invalid': v$.username.$invalid && v$.username.$dirty }\"\n                @blur=\"v$.username.$touch()\"\n              />\n              <small v-if=\"v$.username.$invalid && v$.username.$dirty\" class=\"p-error\">\n                {{ v$.username.$errors[0].$message }}\n              </small>\n            </div>\n            \n            <div class=\"p-field\">\n              <label for=\"password\">密碼</label>\n              <Password \n                id=\"password\" \n                v-model=\"password\" \n                placeholder=\"請輸入密碼\" \n                :feedback=\"false\"\n                toggleMask\n                :class=\"{ 'p-invalid': v$.password.$invalid && v$.password.$dirty }\"\n                @blur=\"v$.password.$touch()\"\n              />\n              <small v-if=\"v$.password.$invalid && v$.password.$dirty\" class=\"p-error\">\n                {{ v$.password.$errors[0].$message }}\n              </small>\n            </div>\n            \n            <div class=\"login-actions\">\n              <Button \n                label=\"登入\" \n                icon=\"pi pi-sign-in\" \n                class=\"p-button-lg\" \n                :loading=\"loading\" \n                :disabled=\"loading\" \n                @click=\"login\"\n              />\n            </div>\n          </div>\n        </div>\n      </template>\n    </Card>\n  </div>\n</template>\n\n<script>\nimport { ref, computed } from 'vue'\nimport { useStore } from 'vuex'\nimport { useRouter, useRoute } from 'vue-router'\nimport { useVuelidate } from '@vuelidate/core'\nimport { required, minLength } from '@vuelidate/validators'\n\nexport default {\n  name: 'LoginComponent',\n  \n  setup() {\n    const store = useStore()\n    const router = useRouter()\n    const route = useRoute()\n    \n    // 表單數據\n    const username = ref('')\n    const password = ref('')\n    const loading = ref(false)\n    const errorMessage = ref('')\n    \n    // 表單驗證規則\n    const rules = {\n      username: { required, minLength: minLength(3) },\n      password: { required, minLength: minLength(6) }\n    }\n    \n    const v$ = useVuelidate(rules, { username, password })\n    \n    // 登入方法\n    const login = async () => {\n      try {\n        errorMessage.value = ''\n        \n        // 表單驗證\n        const isFormValid = await v$.value.$validate()\n        if (!isFormValid) {\n          return\n        }\n        \n        loading.value = true\n        \n        // 執行登入操作\n        await store.dispatch('auth/login', {\n          username: username.value,\n          password: password.value\n        })\n        \n        // 登入成功後，根據redirect參數導航\n        const redirectPath = route.query.redirect || '/calendar'\n        router.push(redirectPath)\n      } catch (error) {\n        console.error('登入失敗:', error)\n        errorMessage.value = error.response?.data || '登入失敗，請檢查用戶名和密碼'\n      } finally {\n        loading.value = false\n      }\n    }\n    \n    return {\n      username,\n      password,\n      loading,\n      errorMessage,\n      v$,\n      login\n    }\n  }\n}\n</script>\n\n<style scoped>\n.login-container {\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  min-height: calc(100vh - 100px);\n  padding: 2rem;\n}\n\n.login-card {\n  width: 100%;\n  max-width: 450px;\n  box-shadow: 0 4px 10px rgba(0, 0, 0, 0.05);\n}\n\n.login-title {\n  text-align: center;\n  color: #3B82F6;\n}\n\n.login-form {\n  margin-top: 1rem;\n}\n\n.p-field {\n  margin-bottom: 1.5rem;\n}\n\n.p-field label {\n  display: block;\n  margin-bottom: 0.5rem;\n  font-weight: 600;\n}\n\n.login-actions {\n  margin-top: 2rem;\n  display: flex;\n  justify-content: center;\n}\n\n.p-error {\n  color: #f44336;\n  font-size: 0.875rem;\n}\n</style>"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}