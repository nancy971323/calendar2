{"ast":null,"code":"import _regeneratorRuntime from \"/Users/lidiannan/Documents/GitHub/calendar2/frontend/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";\nimport _asyncToGenerator from \"/Users/lidiannan/Documents/GitHub/calendar2/frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport \"core-js/modules/es.array.push.js\";\nimport { ref, computed } from 'vue';\nimport { useStore } from 'vuex';\nimport { useRouter, useRoute } from 'vue-router';\nimport { useVuelidate } from '@vuelidate/core';\nimport { required, minLength } from '@vuelidate/validators';\nexport default {\n  name: 'LoginComponent',\n  setup: function setup() {\n    var store = useStore();\n    var router = useRouter();\n    var route = useRoute();\n\n    // 表單數據\n    var username = ref('');\n    var password = ref('');\n    var loading = ref(false);\n    var errorMessage = ref('');\n\n    // 表單驗證規則\n    var rules = {\n      username: {\n        required: required,\n        minLength: minLength(3)\n      },\n      password: {\n        required: required,\n        minLength: minLength(6)\n      }\n    };\n    var v$ = useVuelidate(rules, {\n      username: username,\n      password: password\n    });\n\n    // 登入方法\n    var login = /*#__PURE__*/function () {\n      var _ref = _asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee() {\n        var isFormValid, redirectPath, _error$response;\n        return _regeneratorRuntime().wrap(function _callee$(_context) {\n          while (1) switch (_context.prev = _context.next) {\n            case 0:\n              _context.prev = 0;\n              errorMessage.value = '';\n\n              // 表單驗證\n              _context.next = 4;\n              return v$.value.$validate();\n            case 4:\n              isFormValid = _context.sent;\n              if (isFormValid) {\n                _context.next = 7;\n                break;\n              }\n              return _context.abrupt(\"return\");\n            case 7:\n              loading.value = true;\n\n              // 執行登入操作\n              _context.next = 10;\n              return store.dispatch('auth/login', {\n                username: username.value,\n                password: password.value\n              });\n            case 10:\n              // 登入成功後，根據redirect參數導航\n              redirectPath = route.query.redirect || '/calendar';\n              router.push(redirectPath);\n              _context.next = 18;\n              break;\n            case 14:\n              _context.prev = 14;\n              _context.t0 = _context[\"catch\"](0);\n              console.error('登入失敗:', _context.t0);\n              errorMessage.value = ((_error$response = _context.t0.response) === null || _error$response === void 0 ? void 0 : _error$response.data) || '登入失敗，請檢查用戶名和密碼';\n            case 18:\n              _context.prev = 18;\n              loading.value = false;\n              return _context.finish(18);\n            case 21:\n            case \"end\":\n              return _context.stop();\n          }\n        }, _callee, null, [[0, 14, 18, 21]]);\n      }));\n      return function login() {\n        return _ref.apply(this, arguments);\n      };\n    }();\n    return {\n      username: username,\n      password: password,\n      loading: loading,\n      errorMessage: errorMessage,\n      v$: v$,\n      login: login\n    };\n  }\n};","map":{"version":3,"names":["ref","computed","useStore","useRouter","useRoute","useVuelidate","required","minLength","name","setup","store","router","route","username","password","loading","errorMessage","rules","v$","login","_ref","_asyncToGenerator","_regeneratorRuntime","mark","_callee","isFormValid","redirectPath","_error$response","wrap","_callee$","_context","prev","next","value","$validate","sent","abrupt","dispatch","query","redirect","push","t0","console","error","response","data","finish","stop","apply","arguments"],"sources":["/Users/lidiannan/Documents/GitHub/calendar2/frontend/src/components/Login.vue"],"sourcesContent":["<template>\n  <div class=\"login-container\">\n    <Card class=\"login-card\">\n      <template #title>\n        <h1 class=\"login-title\">登入系統</h1>\n      </template>\n      <template #content>\n        <div class=\"login-form\">\n          <Message v-if=\"errorMessage\" severity=\"error\" :closable=\"false\">{{ errorMessage }}</Message>\n          \n          <div class=\"p-fluid\">\n            <div class=\"p-field\">\n              <label for=\"username\">用戶名</label>\n              <InputText \n                id=\"username\" \n                v-model.trim=\"username\" \n                placeholder=\"請輸入用戶名\"\n                :class=\"{ 'p-invalid': v$.username.$invalid && v$.username.$dirty }\"\n                @blur=\"v$.username.$touch()\"\n              />\n              <small v-if=\"v$.username.$invalid && v$.username.$dirty\" class=\"p-error\">\n                {{ v$.username.$errors[0].$message }}\n              </small>\n            </div>\n            \n            <div class=\"p-field\">\n              <label for=\"password\">密碼</label>\n              <Password \n                id=\"password\" \n                v-model=\"password\" \n                placeholder=\"請輸入密碼\" \n                :feedback=\"false\"\n                toggleMask\n                :class=\"{ 'p-invalid': v$.password.$invalid && v$.password.$dirty }\"\n                @blur=\"v$.password.$touch()\"\n              />\n              <small v-if=\"v$.password.$invalid && v$.password.$dirty\" class=\"p-error\">\n                {{ v$.password.$errors[0].$message }}\n              </small>\n            </div>\n            \n            <div class=\"login-actions\">\n              <Button \n                label=\"登入\" \n                icon=\"pi pi-sign-in\" \n                class=\"p-button-lg\" \n                :loading=\"loading\" \n                :disabled=\"loading\" \n                @click=\"login\"\n              />\n            </div>\n          </div>\n        </div>\n      </template>\n    </Card>\n  </div>\n</template>\n\n<script>\nimport { ref, computed } from 'vue'\nimport { useStore } from 'vuex'\nimport { useRouter, useRoute } from 'vue-router'\nimport { useVuelidate } from '@vuelidate/core'\nimport { required, minLength } from '@vuelidate/validators'\n\nexport default {\n  name: 'LoginComponent',\n  \n  setup() {\n    const store = useStore()\n    const router = useRouter()\n    const route = useRoute()\n    \n    // 表單數據\n    const username = ref('')\n    const password = ref('')\n    const loading = ref(false)\n    const errorMessage = ref('')\n    \n    // 表單驗證規則\n    const rules = {\n      username: { required, minLength: minLength(3) },\n      password: { required, minLength: minLength(6) }\n    }\n    \n    const v$ = useVuelidate(rules, { username, password })\n    \n    // 登入方法\n    const login = async () => {\n      try {\n        errorMessage.value = ''\n        \n        // 表單驗證\n        const isFormValid = await v$.value.$validate()\n        if (!isFormValid) {\n          return\n        }\n        \n        loading.value = true\n        \n        // 執行登入操作\n        await store.dispatch('auth/login', {\n          username: username.value,\n          password: password.value\n        })\n        \n        // 登入成功後，根據redirect參數導航\n        const redirectPath = route.query.redirect || '/calendar'\n        router.push(redirectPath)\n      } catch (error) {\n        console.error('登入失敗:', error)\n        errorMessage.value = error.response?.data || '登入失敗，請檢查用戶名和密碼'\n      } finally {\n        loading.value = false\n      }\n    }\n    \n    return {\n      username,\n      password,\n      loading,\n      errorMessage,\n      v$,\n      login\n    }\n  }\n}\n</script>\n\n<style scoped>\n.login-container {\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  min-height: calc(100vh - 100px);\n  padding: 2rem;\n}\n\n.login-card {\n  width: 100%;\n  max-width: 450px;\n  box-shadow: 0 4px 10px rgba(0, 0, 0, 0.05);\n}\n\n.login-title {\n  text-align: center;\n  color: #3B82F6;\n}\n\n.login-form {\n  margin-top: 1rem;\n}\n\n.p-field {\n  margin-bottom: 1.5rem;\n}\n\n.p-field label {\n  display: block;\n  margin-bottom: 0.5rem;\n  font-weight: 600;\n}\n\n.login-actions {\n  margin-top: 2rem;\n  display: flex;\n  justify-content: center;\n}\n\n.p-error {\n  color: #f44336;\n  font-size: 0.875rem;\n}\n</style>"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}